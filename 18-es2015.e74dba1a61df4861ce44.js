(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"2ZYK":function(t,e,r){"use strict";r.r(e),r.d(e,"FormDemoModule",(function(){return Q}));var o=r("2kYt"),s=r("nIj0"),i=r("PBFl"),a=r("Meci"),n=r("+Tre"),c=r("29Wa"),d=r("Cd2c"),u=r("R7+U"),b=r("sEIs"),h=r("bwdy"),l=r("C05f"),m=r("Ohay"),p=r("EM62"),f=r("tUta"),_=r("bFHC"),g=r("AZyY"),v=r("7V4E");const S=["errorCardWrapper"];function y(t,e){if(1&t&&(p.Sb(0,"ps-block-ui",7),p.hc(1),p.Rb()),2&t){const t=p.dc(2);p.jc("blocked",t.contentBlocked)}}function w(t,e){if(1&t&&(p.Sb(0,"mat-icon",10),p.Ac(1),p.Rb()),2&t){const t=p.dc(3);p.Ab(1),p.Bc(t.exception.icon)}}function k(t,e){if(1&t&&(p.Sb(0,"mat-card",8),p.yc(1,w,2,1,"mat-icon",9),p.Sb(2,"span"),p.Ac(3),p.ec(4,"psErrorMessage"),p.Rb(),p.Rb()),2&t){const t=p.dc(2);p.Eb("ps-form__error-container--center",t.exception.alignCenter),p.Ab(1),p.jc("ngIf",t.exception.icon),p.Ab(2),p.Bc(p.fc(4,4,t.exception.errorObject))}}function x(t,e){if(1&t&&(p.Sb(0,"mat-icon"),p.Ac(1),p.Rb()),2&t){const t=p.dc().$implicit;p.Ab(1),p.Bc(t.icon)}}function C(t,e){if(1&t&&(p.Sb(0,"button",17),p.Zb("click",(function(){return e.$implicit.click()})),p.yc(1,x,2,1,"mat-icon",18),p.Ac(2),p.Rb()),2&t){const t=e.$implicit;p.Eb("mat-raised-button","raised"===t.type)("mat-stroked-button","stroked"===t.type)("mat-icon-button","icon"===t.type),p.jc("color",t.color)("disabled",t.disabled&&t.disabled()),p.Ab(1),p.jc("ngIf",t.icon),p.Ab(1),p.Cc(" ",t.label," ")}}function E(t,e){if(1&t&&(p.Sb(0,"mat-card",11),p.Sb(1,"div",12),p.Nb(2,"ps-form-errors",13),p.Nb(3,"div",14),p.Sb(4,"div",15),p.hc(5,1),p.yc(6,C,3,10,"button",16),p.Rb(),p.Rb(),p.Rb()),2&t){const t=p.dc(2);p.Eb("ps-form__savebar--sticky",t.savebarSticky),p.Ab(2),p.jc("form",t.form),p.Ab(4),p.jc("ngForOf",t.buttons)}}function R(t,e){if(1&t&&(p.Sb(0,"form",1),p.Sb(1,"div",2),p.yc(2,y,2,1,"ps-block-ui",3),p.Sb(3,"div",null,4),p.yc(5,k,5,6,"mat-card",5),p.Rb(),p.Rb(),p.yc(6,E,7,4,"mat-card",6),p.Rb()),2&t){const t=p.dc();p.jc("formGroup",t.form)("autocomplete",t.autocomplete),p.Ab(2),p.jc("ngIf",t.contentVisible),p.Ab(1),p.vc("display",t.exception?"block":"none"),p.Ab(2),p.jc("ngIf",t.exception),p.Ab(1),p.jc("ngIf",!t.savebarHidden)}}const A=["*",[["","psFormSavebarButtons",""]]],j=["*","[psFormSavebarButtons]"],M={IntersectionObserver};let I=(()=>{class t{constructor(t){this.cd=t,this._dataSourceSub=h.a.EMPTY,this._viewReady=!1,this._errrorInView$=new l.a(!1)}set dataSource(t){this._dataSource&&(this._dataSource.disconnect(),this._dataSourceSub.unsubscribe()),this._dataSource=t,this.updateErrorCardObserver(),this._dataSource&&this.activateDataSource()}get dataSource(){return this._dataSource}get autocomplete(){return this.dataSource.autocomplete}get form(){return this.dataSource.form}get buttons(){return this.dataSource.buttons}get savebarMode(){return this.dataSource.savebarMode||"auto"}get savebarHidden(){return"hide"===this.savebarMode}get savebarSticky(){return"auto"===this.savebarMode?this.form.dirty||this.form.touched:"sticky"===this.savebarMode}get contentVisible(){return this.dataSource.contentVisible}get contentBlocked(){return this.dataSource.contentBlocked}get exception(){return this.dataSource.exception}ngAfterViewInit(){this._viewReady=!0,this.updateErrorCardObserver(),this.activateDataSource()}ngOnDestroy(){this._errorCardObserver&&(this._errorCardObserver.disconnect(),this._errorCardObserver=null),this._errrorInView$.complete(),this._dataSourceSub.unsubscribe(),this._dataSource&&this._dataSource.disconnect()}activateDataSource(){if(!this._viewReady||!this._dataSource)return;const t={errorInView$:this._errrorInView$.pipe(Object(m.a)()),scrollToError:()=>{this.errorCardWrapper.nativeElement.scrollIntoView({behavior:"smooth"})}};this._dataSourceSub=this._dataSource.connect(t).subscribe(()=>{this.cd.markForCheck()})}updateErrorCardObserver(){!this._errorCardObserver&&this._dataSource&&this._viewReady?(this._errorCardObserver=new M.IntersectionObserver((t,e)=>{this._errrorInView$.next(t[0].intersectionRatio>0),this.cd.markForCheck()},{root:null,rootMargin:"-100px",threshold:0}),this._errorCardObserver.observe(this.errorCardWrapper.nativeElement)):this._errorCardObserver&&!this._dataSource&&(this._errorCardObserver.disconnect(),this._errorCardObserver=null)}}return t.\u0275fac=function(e){return new(e||t)(p.Mb(p.h))},t.\u0275cmp=p.Gb({type:t,selectors:[["ps-form"]],viewQuery:function(t,e){var r;1&t&&p.Ec(S,!0),2&t&&p.nc(r=p.ac())&&(e.errorCardWrapper=r.first)},inputs:{dataSource:"dataSource"},ngContentSelectors:j,decls:1,vars:1,consts:[["class","ps-form__main-container",3,"formGroup","autocomplete",4,"ngIf"],[1,"ps-form__main-container",3,"formGroup","autocomplete"],[1,"ps-form__cards-container"],[3,"blocked",4,"ngIf"],["errorCardWrapper",""],["class","ps-form__error-container",3,"ps-form__error-container--center",4,"ngIf"],["class","ps-form__savebar",3,"ps-form__savebar--sticky",4,"ngIf"],[3,"blocked"],[1,"ps-form__error-container"],["class","ps-form__error-icon",4,"ngIf"],[1,"ps-form__error-icon"],[1,"ps-form__savebar"],[1,"ps-form__savebar-container"],[3,"form"],[1,"ps-form__savebar-spacer"],[1,"ps-form__buttons"],["mat-button","","type","button",3,"mat-raised-button","mat-stroked-button","mat-icon-button","color","disabled","click",4,"ngFor","ngForOf"],["mat-button","","type","button",3,"color","disabled","click"],[4,"ngIf"]],template:function(t,e){1&t&&(p.ic(A),p.yc(0,R,7,7,"form",0)),2&t&&p.jc("ngIf",e.dataSource)},directives:[o.m,s.v,s.o,s.i,f.a,a.a,_.a,g.a,o.l,i.a],pipes:[v.a],styles:[".ps-form__main-container{box-sizing:border-box}.ps-form__cards-container{display:grid;grid-gap:1em}mat-card.ps-form__error-container{color:var(--ps-error)}mat-card.ps-form__error-container--center{display:grid;justify-items:center}mat-icon.ps-form__error-icon{color:var(--ps-error);font-size:72px;height:72px;width:72px}.ps-form__buttons button{margin:.25em}.ps-form__error-notfier-button{vertical-align:middle;cursor:pointer}.ps-form__savebar{bottom:-1px;margin:1em 0;z-index:5;padding:1em!important;display:flex;justify-content:space-between;border-top:5px solid var(--ps-accent)}mat-card.ps-form__savebar--sticky{position:-webkit-sticky;position:sticky}.ps-form__savebar-container{display:flex;flex-wrap:wrap;justify-content:flex-end;margin:-.25em;width:100%}.ps-form__savebar-container button{margin:.25em}.ps-form__savebar-spacer{margin-right:auto}@media only screen and (max-width:35em){mat-card.ps-form__savebar--sticky{position:static}}"],encapsulation:2,changeDetection:0}),t})();var O=r("TqqQ"),V=r("aCbn"),D=r("sKM9");let $=(()=>{class t{}return t.\u0275mod=p.Kb({type:t}),t.\u0275inj=p.Jb({factory:function(e){return new(e||t)},imports:[[o.c,s.s,a.e,_.b,i.b,O.a,D.a,V.a]]}),t})();var B=r("XoY3"),T=r("/BkX"),F=r("/nyh"),N=r("mFH5"),P=r("ZTXN"),Y=r("ROBh"),q=r("J+dc"),G=r("BwBJ"),Z=r("YtkY"),z=r("8j5Y");function J(t,e){if(1&t&&(p.Sb(0,"div",13),p.Ac(1),p.ec(2,"json"),p.Rb()),2&t){const t=e.$implicit;p.Ab(1),p.Bc(p.fc(2,1,t))}}class W{constructor(t){this.options=t,this.autocomplete="off",this.buttons=[],this._originalData=null,this._loading=!1,this._hasLoadError=!1,this._saving=!1,this._blockView=!1,this._isEditMode=!1,this._errorInView=!1,this.stateChanges$=new P.a,this._loadParams=null,this.buttonDefs={scrollToError:{type:"icon",icon:"error_outline",color:"warn",click:()=>this._scrollToError()},edit:{label:"bearbeiten",type:"raised",color:"primary",disabled:()=>this.contentBlocked,click:()=>this.edit()},save:{label:"speichern",type:"raised",color:"primary",disabled:()=>this.contentBlocked||!this.form.valid,click:()=>this.save()},cancel:{label:"cancel",type:"stroked",color:null,disabled:()=>!1,click:()=>this.reset()}},this._loadingSub=h.a.EMPTY,this._connectSub=h.a.EMPTY,this._errorInViewSub=h.a.EMPTY}get form(){return this.options.form}get contentVisible(){return!this._hasLoadError}get contentBlocked(){return this._loading||this._saving||this._blockView}get savebarMode(){return this._hasLoadError?"hide":"auto"}connect(t){return this._scrollToError=()=>setTimeout(()=>t.scrollToError(),0),this._errorInViewSub=t.errorInView$.subscribe(t=>{this._errorInView=t,this.updateButtons(),this.stateChanges$.next()}),this._connectSub=this.options.loadTrigger$.subscribe(t=>{this._loadParams=t,this.loadData(t)}),this.stateChanges$}disconnect(){this._connectSub.unsubscribe(),this._errorInViewSub.unsubscribe(),this._loadingSub.unsubscribe()}setViewBlocked(t){this._blockView=t,this.stateChanges$.next()}edit(){this.setEditMode(!0)}save(){this._saving=!0,this.exception=null,this.stateChanges$.next();const t=this.form.getRawValue();this.options.saveFn(t,this._loadParams).pipe(Object(q.a)(1)).subscribe({next:t=>{this.markDataSaved(),this.setEditMode(!1),this._saving=!1,this.stateChanges$.next()},error:t=>{this._saving=!1,this.exception={errorObject:t},this._errorInView||this._scrollToError(),this.updateButtons(),this.stateChanges$.next()}})}reset(){this.resetData(),this.setEditMode(!1),this.stateChanges$.next()}loadData(t){this._loadingSub.unsubscribe(),this._loading=!0,this._hasLoadError=!1,this.exception=null,this.initializeData(null),this.setEditMode(!1),this.stateChanges$.next(),this._loadingSub=this.options.loadFn(t).pipe(Object(q.a)(1)).subscribe({next:t=>{this.initializeData(t),this._loading=!1,this.stateChanges$.next()},error:t=>{this._loading=!1,this._hasLoadError=!0,this.exception={errorObject:t,alignCenter:!0,icon:"sentiment_very_dissatisfied"},this.stateChanges$.next()}})}initializeData(t){null==t?this.form.reset():this.form.patchValue(t),this.markDataSaved()}markDataSaved(){this._originalData=this.form.getRawValue(),this.form.markAsPristine(),this.form.markAsUntouched()}resetData(){this.form.patchValue(this._originalData),this.form.markAsPristine(),this.form.markAsUntouched()}setEditMode(t){this._isEditMode=t,t?this.form.enable():this.form.disable(),this.updateButtons()}updateButtons(){this.buttons=[],this.contentVisible&&(this._isEditMode?(this.exception&&!this._errorInView&&this.buttons.push(this.buttonDefs.scrollToError),this.buttons.push(this.buttonDefs.save),this.buttons.push(this.buttonDefs.cancel)):this.buttons.push(this.buttonDefs.edit))}}let L=(()=>{class t{constructor(){this.loadError=!1,this.saveError=!1,this.form=new s.h({input1:new s.e("a"),input2:new s.e("b")},[t=>t.value.input1===t.value.input2?null:{equal:"input1 and input2 must be equal"}]),this.counter=0,this.loadTrigger$=new l.a(this.counter),this.logs=[],this.dataSource=new W({form:this.form,loadTrigger$:this.loadTrigger$,loadFn:t=>(this.logs.push({type:"load",params:t}),Object(Y.a)({input1:"input 1 load count "+t,input2:"input 2 load count "+t}).pipe(Object(G.a)(1e3),Object(Z.a)(t=>{if(this.loadError)throw new Error("this is the server error (loading)");return t}))),saveFn:(t,e)=>(this.logs.push({type:"save",data:t,params:e}),Object(Y.a)(null).pipe(Object(G.a)(1e3),Object(z.a)(t=>{if(this.saveError)throw new Error("this is the server error (saving)");return t})))})}reload(){this.loadTrigger$.next(++this.counter)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Gb({type:t,selectors:[["app-form-data-source-demo"]],decls:28,vars:5,consts:[[1,"app-form-data-source-demo__settings"],[3,"ngModel","ngModelChange"],["mat-flat-button","","type","button","color","accent",3,"click"],[1,"app-form-data-source-demo__grid"],[3,"dataSource"],[3,"formGroup"],["type","text","matInput","","formControlName","input1"],["type","text","matInput","","formControlName","input2"],[2,"height","500px","margin-top","1em"],["psFormSavebarButtons",""],["mat-stroked-button","","type","button"],[1,"app-form-data-source-demo__logs"],["class","app-form-data-source-demo__log-item",4,"ngFor","ngForOf"],[1,"app-form-data-source-demo__log-item"]],template:function(t,e){1&t&&(p.Sb(0,"mat-card",0),p.Sb(1,"mat-checkbox",1),p.Zb("ngModelChange",(function(t){return e.loadError=t})),p.Ac(2,"load error"),p.Rb(),p.Sb(3,"mat-checkbox",1),p.Zb("ngModelChange",(function(t){return e.saveError=t})),p.Ac(4,"save error"),p.Rb(),p.Sb(5,"button",2),p.Zb("click",(function(){return e.reload()})),p.Ac(6,"reload"),p.Rb(),p.Rb(),p.Sb(7,"div",3),p.Sb(8,"ps-form",4),p.Sb(9,"mat-card"),p.Sb(10,"form",5),p.Sb(11,"mat-form-field"),p.Sb(12,"mat-label"),p.Ac(13,"Input 1"),p.Rb(),p.Nb(14,"input",6),p.Rb(),p.Sb(15,"mat-form-field"),p.Sb(16,"mat-label"),p.Ac(17,"Input 2"),p.Rb(),p.Nb(18,"input",7),p.Rb(),p.Rb(),p.Rb(),p.Sb(19,"mat-card",8),p.Ac(20,"dummy card"),p.Rb(),p.Qb(21,9),p.Sb(22,"button",10),p.Ac(23,"dummy button 1"),p.Rb(),p.Sb(24,"button",10),p.Ac(25,"dummy button 2"),p.Rb(),p.Pb(),p.Rb(),p.Sb(26,"mat-card",11),p.yc(27,J,3,3,"div",12),p.Rb(),p.Rb()),2&t&&(p.Ab(1),p.jc("ngModel",e.loadError),p.Ab(2),p.jc("ngModel",e.saveError),p.Ab(5),p.jc("dataSource",e.dataSource),p.Ab(2),p.jc("formGroup",e.form),p.Ab(17),p.jc("ngForOf",e.logs))},directives:[a.a,n.a,s.n,s.q,i.a,I,s.v,s.o,s.i,c.d,c.h,d.a,s.c,s.g,o.l],pipes:[o.g],styles:["\n      .app-form-data-source-demo__settings {\n        margin-bottom: 1em;\n      }\n\n      .app-form-data-source-demo__settings mat-checkbox {\n        margin: 1em;\n      }\n\n      .app-form-data-source-demo__grid {\n        display: grid;\n        grid-template-columns: 2fr 1fr;\n        grid-gap: 1em;\n      }\n\n      .app-form-data-source-demo__log-item {\n        margin-bottom: 0.25em;\n        padding-bottom: 0.25em;\n        border-bottom: 1px solid #ccc;\n        font-size: 0.95em;\n      }\n\n      app-form-demo .mat-form-field {\n        display: block;\n      }\n    "],encapsulation:2,changeDetection:0}),t})();function H(t,e){1&t&&p.Nb(0,"app-form-data-source-demo")}let K=(()=>{class t{constructor(){this.demoType="dataSource"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Gb({type:t,selectors:[["app-form-demo"]],decls:7,vars:4,consts:[[1,"app-form-demo__settings"],[3,"ngModel","ngModelChange"],[3,"value"],[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(t,e){1&t&&(p.Sb(0,"mat-card",0),p.Sb(1,"mat-form-field"),p.Sb(2,"mat-select",1),p.Zb("ngModelChange",(function(t){return e.demoType=t})),p.Sb(3,"mat-option",2),p.Ac(4,"dataSource"),p.Rb(),p.Rb(),p.Rb(),p.Rb(),p.Qb(5,3),p.yc(6,H,1,0,"app-form-data-source-demo",4),p.Pb()),2&t&&(p.Ab(2),p.jc("ngModel",e.demoType),p.Ab(1),p.jc("value","dataSource"),p.Ab(2),p.jc("ngSwitch",e.demoType),p.Ab(1),p.jc("ngSwitchCase","dataSource"))},directives:[a.a,c.d,u.a,s.n,s.q,N.k,o.o,o.p,L],styles:[".app-form-demo__settings[_ngcontent-%COMP%] {\n        margin-bottom: 1em;\n      }"],changeDetection:0}),t})();r("89kn");let Q=(()=>{class t{}return t.\u0275mod=p.Kb({type:t}),t.\u0275inj=p.Jb({factory:function(e){return new(e||t)},imports:[[s.j,s.s,o.c,B.b.forRoot(F.a),T.a,$,b.d.forChild([{path:"",component:K}]),d.b,c.f,a.e,n.b,u.b,i.b]]}),t})()},BwBJ:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var o=r("Efrr"),s=r("5uGe"),i=r("ryP2");function a(t,e=o.a){var r;const s=(r=t)instanceof Date&&!isNaN(+r)?+t-e.now():Math.abs(t);return t=>t.lift(new n(s,e))}class n{constructor(t,e){this.delay=t,this.scheduler=e}call(t,e){return e.subscribe(new c(t,this.delay,this.scheduler))}}class c extends s.a{constructor(t,e,r){super(t),this.delay=e,this.scheduler=r,this.queue=[],this.active=!1,this.errored=!1}static dispatch(t){const e=t.source,r=e.queue,o=t.scheduler,s=t.destination;for(;r.length>0&&r[0].time-o.now()<=0;)r.shift().notification.observe(s);if(r.length>0){const e=Math.max(0,r[0].time-o.now());this.schedule(t,e)}else this.unsubscribe(),e.active=!1}_schedule(t){this.active=!0,this.destination.add(t.schedule(c.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))}scheduleNotification(t){if(!0===this.errored)return;const e=this.scheduler,r=new d(e.now()+this.delay,t);this.queue.push(r),!1===this.active&&this._schedule(e)}_next(t){this.scheduleNotification(i.a.createNext(t))}_error(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()}_complete(){this.scheduleNotification(i.a.createComplete()),this.unsubscribe()}}class d{constructor(t,e){this.time=t,this.notification=e}}}}]);