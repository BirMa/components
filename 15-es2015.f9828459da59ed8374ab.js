(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"/nyh":function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var o=r("XoY3"),i=r("ROBh");class s extends o.a{getLabel(t){return t.psLabel?Object(i.a)(t.psLabel):null}mapDataToError(t){return Object(i.a)(t.map(t=>({errorText:`${t.controlPath} - ${t.errorKey} - ${JSON.stringify(t.errorValue)}`,data:t})))}}},"2ZYK":function(t,e,r){"use strict";r.r(e),r.d(e,"FormDemoModule",(function(){return X}));var o=r("2kYt"),i=r("nIj0"),s=r("PBFl"),a=r("Meci"),n=r("+Tre"),c=r("29Wa"),d=r("Cd2c"),u=r("R7+U"),b=r("sEIs"),h=r("bwdy"),l=r("C05f"),m=r("Ohay"),p=r("EM62"),f=r("tUta"),_=r("bFHC"),g=r("AZyY"),v=r("7V4E");const y=["errorCardWrapper"];function w(t,e){if(1&t&&(p.Rb(0,"ps-block-ui",7),p.gc(1),p.Qb()),2&t){const t=p.cc(2);p.ic("blocked",t.contentBlocked)}}function S(t,e){if(1&t&&(p.Rb(0,"mat-icon",10),p.zc(1),p.Qb()),2&t){const t=p.cc(3);p.Ab(1),p.Ac(t.exception.icon)}}function k(t,e){if(1&t&&(p.Rb(0,"mat-card",8),p.xc(1,S,2,1,"mat-icon",9),p.Rb(2,"span"),p.zc(3),p.dc(4,"psErrorMessage"),p.Qb(),p.Qb()),2&t){const t=p.cc(2);p.Db("ps-form__error-container--center",t.exception.alignCenter),p.Ab(1),p.ic("ngIf",t.exception.icon),p.Ab(2),p.Ac(p.ec(4,4,t.exception.errorObject))}}function x(t,e){if(1&t&&(p.Rb(0,"mat-icon"),p.zc(1),p.Qb()),2&t){const t=p.cc().$implicit;p.Ab(1),p.Ac(t.icon)}}function C(t,e){if(1&t&&(p.Rb(0,"button",17),p.Yb("click",(function(){return e.$implicit.click()})),p.xc(1,x,2,1,"mat-icon",18),p.zc(2),p.Qb()),2&t){const t=e.$implicit;p.Db("mat-raised-button","raised"===t.type)("mat-stroked-button","stroked"===t.type)("mat-icon-button","icon"===t.type),p.ic("color",t.color)("disabled",t.disabled&&t.disabled()),p.Ab(1),p.ic("ngIf",t.icon),p.Ab(1),p.Bc(" ",t.label," ")}}function E(t,e){if(1&t&&(p.Rb(0,"mat-card",11),p.Rb(1,"div",12),p.Mb(2,"ps-form-errors",13),p.Mb(3,"div",14),p.Rb(4,"div",15),p.gc(5,1),p.xc(6,C,3,10,"button",16),p.Qb(),p.Qb(),p.Qb()),2&t){const t=p.cc(2);p.Db("ps-form__savebar--sticky",t.savebarSticky),p.Ab(2),p.ic("form",t.form),p.Ab(4),p.ic("ngForOf",t.buttons)}}function R(t,e){if(1&t&&(p.Rb(0,"form",1),p.Rb(1,"div",2),p.xc(2,w,2,1,"ps-block-ui",3),p.Rb(3,"div",null,4),p.xc(5,k,5,6,"mat-card",5),p.Qb(),p.Qb(),p.xc(6,E,7,4,"mat-card",6),p.Qb()),2&t){const t=p.cc();p.ic("formGroup",t.form)("autocomplete",t.autocomplete),p.Ab(2),p.ic("ngIf",t.contentVisible),p.Ab(1),p.uc("display",t.exception?"block":"none"),p.Ab(2),p.ic("ngIf",t.exception),p.Ab(1),p.ic("ngIf",!t.savebarHidden)}}const M=["*",[["","psFormSavebarButtons",""]]],O=["*","[psFormSavebarButtons]"],I={IntersectionObserver};let Q=(()=>{class t{constructor(t){this.cd=t,this._dataSourceSub=h.a.EMPTY,this._viewReady=!1,this._errrorInView$=new l.a(!1)}set dataSource(t){this._dataSource&&(this._dataSource.disconnect(),this._dataSourceSub.unsubscribe()),this._dataSource=t,this.updateErrorCardObserver(),this._dataSource&&this.activateDataSource()}get dataSource(){return this._dataSource}get autocomplete(){return this.dataSource.autocomplete}get form(){return this.dataSource.form}get buttons(){return this.dataSource.buttons}get savebarMode(){return this.dataSource.savebarMode||"auto"}get savebarHidden(){return"hide"===this.savebarMode}get savebarSticky(){return"auto"===this.savebarMode?this.form.dirty||this.form.touched:"sticky"===this.savebarMode}get contentVisible(){return this.dataSource.contentVisible}get contentBlocked(){return this.dataSource.contentBlocked}get exception(){return this.dataSource.exception}ngAfterViewInit(){this._viewReady=!0,this.updateErrorCardObserver(),this.activateDataSource()}ngOnDestroy(){this._errorCardObserver&&(this._errorCardObserver.disconnect(),this._errorCardObserver=null),this._errrorInView$.complete(),this._dataSourceSub.unsubscribe(),this._dataSource&&this._dataSource.disconnect()}activateDataSource(){if(!this._viewReady||!this._dataSource)return;const t={errorInView$:this._errrorInView$.pipe(Object(m.a)()),scrollToError:()=>{this.errorCardWrapper.nativeElement.scrollIntoView({behavior:"smooth"})}};this._dataSourceSub=this._dataSource.connect(t).subscribe(()=>{this.cd.markForCheck()})}updateErrorCardObserver(){!this._errorCardObserver&&this._dataSource&&this._viewReady?(this._errorCardObserver=new I.IntersectionObserver((t,e)=>{this._errrorInView$.next(t[0].intersectionRatio>0),this.cd.markForCheck()},{root:null,rootMargin:"-100px",threshold:0}),this._errorCardObserver.observe(this.errorCardWrapper.nativeElement)):this._errorCardObserver&&!this._dataSource&&(this._errorCardObserver.disconnect(),this._errorCardObserver=null)}}return t.\u0275fac=function(e){return new(e||t)(p.Lb(p.h))},t.\u0275cmp=p.Fb({type:t,selectors:[["ps-form"]],viewQuery:function(t,e){var r;1&t&&p.Dc(y,!0),2&t&&p.mc(r=p.Zb())&&(e.errorCardWrapper=r.first)},inputs:{dataSource:"dataSource"},ngContentSelectors:O,decls:1,vars:1,consts:[["class","ps-form__main-container",3,"formGroup","autocomplete",4,"ngIf"],[1,"ps-form__main-container",3,"formGroup","autocomplete"],[1,"ps-form__cards-container"],[3,"blocked",4,"ngIf"],["errorCardWrapper",""],["class","ps-form__error-container",3,"ps-form__error-container--center",4,"ngIf"],["class","ps-form__savebar",3,"ps-form__savebar--sticky",4,"ngIf"],[3,"blocked"],[1,"ps-form__error-container"],["class","ps-form__error-icon",4,"ngIf"],[1,"ps-form__error-icon"],[1,"ps-form__savebar"],[1,"ps-form__savebar-container"],[3,"form"],[1,"ps-form__savebar-spacer"],[1,"ps-form__buttons"],["mat-button","","type","button",3,"mat-raised-button","mat-stroked-button","mat-icon-button","color","disabled","click",4,"ngFor","ngForOf"],["mat-button","","type","button",3,"color","disabled","click"],[4,"ngIf"]],template:function(t,e){1&t&&(p.hc(M),p.xc(0,R,7,7,"form",0)),2&t&&p.ic("ngIf",e.dataSource)},directives:[o.m,i.v,i.o,i.i,f.a,a.a,_.a,g.a,o.l,s.a],pipes:[v.a],styles:[".ps-form__main-container{box-sizing:border-box}.ps-form__cards-container{display:grid;grid-gap:1em}mat-card.ps-form__error-container{color:var(--ps-error)}mat-card.ps-form__error-container--center{display:grid;justify-items:center}mat-icon.ps-form__error-icon{color:var(--ps-error);font-size:72px;height:72px;width:72px}.ps-form__buttons button{margin:.25em}.ps-form__error-notfier-button{vertical-align:middle;cursor:pointer}.ps-form__savebar{bottom:-1px;margin:1em 0;z-index:5;padding:1em!important;display:flex;justify-content:space-between;border-top:5px solid var(--ps-accent)}mat-card.ps-form__savebar--sticky{position:-webkit-sticky;position:sticky}.ps-form__savebar-container{display:flex;flex-wrap:wrap;justify-content:flex-end;margin:-.25em;width:100%}.ps-form__savebar-container button{margin:.25em}.ps-form__savebar-spacer{margin-right:auto}@media only screen and (max-width:35em){mat-card.ps-form__savebar--sticky{position:static}}"],encapsulation:2,changeDetection:0}),t})();var A=r("TqqQ"),D=r("aCbn"),V=r("sKM9");let $=(()=>{class t{}return t.\u0275mod=p.Jb({type:t}),t.\u0275inj=p.Ib({factory:function(e){return new(e||t)},imports:[[o.c,i.s,a.c,_.b,s.b,A.a,V.a,D.a]]}),t})();var T=r("XoY3"),j=r("/BkX"),B=r("/nyh"),F=r("mFH5"),z=r("ZTXN"),Y=r("ROBh"),P=r("J+dc"),q=r("BwBJ"),N=r("YtkY"),L=r("8j5Y");function J(t,e){if(1&t&&(p.Rb(0,"div",13),p.zc(1),p.dc(2,"json"),p.Qb()),2&t){const t=e.$implicit;p.Ab(1),p.Ac(p.ec(2,1,t))}}class G{constructor(t){this.options=t,this.autocomplete="off",this.buttons=[],this._originalData=null,this._loading=!1,this._hasLoadError=!1,this._saving=!1,this._blockView=!1,this._isEditMode=!1,this._errorInView=!1,this.stateChanges$=new z.a,this._loadParams=null,this.buttonDefs={scrollToError:{type:"icon",icon:"error_outline",color:"warn",click:()=>this._scrollToError()},edit:{label:"bearbeiten",type:"raised",color:"primary",disabled:()=>this.contentBlocked,click:()=>this.edit()},save:{label:"speichern",type:"raised",color:"primary",disabled:()=>this.contentBlocked||!this.form.valid,click:()=>this.save()},cancel:{label:"cancel",type:"stroked",color:null,disabled:()=>!1,click:()=>this.reset()}},this._loadingSub=h.a.EMPTY,this._connectSub=h.a.EMPTY,this._errorInViewSub=h.a.EMPTY}get form(){return this.options.form}get contentVisible(){return!this._hasLoadError}get contentBlocked(){return this._loading||this._saving||this._blockView}get savebarMode(){return this._hasLoadError?"hide":"auto"}connect(t){return this._scrollToError=()=>setTimeout(()=>t.scrollToError(),0),this._errorInViewSub=t.errorInView$.subscribe(t=>{this._errorInView=t,this.updateButtons(),this.stateChanges$.next()}),this._connectSub=this.options.loadTrigger$.subscribe(t=>{this._loadParams=t,this.loadData(t)}),this.stateChanges$}disconnect(){this._connectSub.unsubscribe(),this._errorInViewSub.unsubscribe(),this._loadingSub.unsubscribe()}setViewBlocked(t){this._blockView=t,this.stateChanges$.next()}edit(){this.setEditMode(!0)}save(){this._saving=!0,this.exception=null,this.stateChanges$.next();const t=this.form.getRawValue();this.options.saveFn(t,this._loadParams).pipe(Object(P.a)(1)).subscribe({next:t=>{this.markDataSaved(),this.setEditMode(!1),this._saving=!1,this.stateChanges$.next()},error:t=>{this._saving=!1,this.exception={errorObject:t},this._errorInView||this._scrollToError(),this.updateButtons(),this.stateChanges$.next()}})}reset(){this.resetData(),this.setEditMode(!1),this.stateChanges$.next()}loadData(t){this._loadingSub.unsubscribe(),this._loading=!0,this._hasLoadError=!1,this.exception=null,this.initializeData(null),this.setEditMode(!1),this.stateChanges$.next(),this._loadingSub=this.options.loadFn(t).pipe(Object(P.a)(1)).subscribe({next:t=>{this.initializeData(t),this._loading=!1,this.stateChanges$.next()},error:t=>{this._loading=!1,this._hasLoadError=!0,this.exception={errorObject:t,alignCenter:!0,icon:"sentiment_very_dissatisfied"},this.stateChanges$.next()}})}initializeData(t){null==t?this.form.reset():this.form.patchValue(t),this.markDataSaved()}markDataSaved(){this._originalData=this.form.getRawValue(),this.form.markAsPristine(),this.form.markAsUntouched()}resetData(){this.form.patchValue(this._originalData),this.form.markAsPristine(),this.form.markAsUntouched()}setEditMode(t){this._isEditMode=t,t?this.form.enable():this.form.disable(),this.updateButtons()}updateButtons(){this.buttons=[],this.contentVisible&&(this._isEditMode?(this.exception&&!this._errorInView&&this.buttons.push(this.buttonDefs.scrollToError),this.buttons.push(this.buttonDefs.save),this.buttons.push(this.buttonDefs.cancel)):this.buttons.push(this.buttonDefs.edit))}}let W=(()=>{class t{constructor(){this.loadError=!1,this.saveError=!1,this.form=new i.h({input1:new i.e("a"),input2:new i.e("b")},[t=>t.value.input1===t.value.input2?null:{equal:"input1 and input2 must be equal"}]),this.counter=0,this.loadTrigger$=new l.a(this.counter),this.logs=[],this.dataSource=new G({form:this.form,loadTrigger$:this.loadTrigger$,loadFn:t=>(this.logs.push({type:"load",params:t}),Object(Y.a)({input1:"input 1 load count "+t,input2:"input 2 load count "+t}).pipe(Object(q.a)(1e3),Object(N.a)(t=>{if(this.loadError)throw new Error("this is the server error (loading)");return t}))),saveFn:(t,e)=>(this.logs.push({type:"save",data:t,params:e}),Object(Y.a)(null).pipe(Object(q.a)(1e3),Object(L.a)(t=>{if(this.saveError)throw new Error("this is the server error (saving)");return t})))})}reload(){this.loadTrigger$.next(++this.counter)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Fb({type:t,selectors:[["app-form-data-source-demo"]],decls:28,vars:5,consts:[[1,"app-form-data-source-demo__settings"],[3,"ngModel","ngModelChange"],["mat-flat-button","","type","button","color","accent",3,"click"],[1,"app-form-data-source-demo__grid"],[3,"dataSource"],[3,"formGroup"],["type","text","matInput","","formControlName","input1"],["type","text","matInput","","formControlName","input2"],[2,"height","500px","margin-top","1em"],["psFormSavebarButtons",""],["mat-stroked-button","","type","button"],[1,"app-form-data-source-demo__logs"],["class","app-form-data-source-demo__log-item",4,"ngFor","ngForOf"],[1,"app-form-data-source-demo__log-item"]],template:function(t,e){1&t&&(p.Rb(0,"mat-card",0),p.Rb(1,"mat-checkbox",1),p.Yb("ngModelChange",(function(t){return e.loadError=t})),p.zc(2,"load error"),p.Qb(),p.Rb(3,"mat-checkbox",1),p.Yb("ngModelChange",(function(t){return e.saveError=t})),p.zc(4,"save error"),p.Qb(),p.Rb(5,"button",2),p.Yb("click",(function(){return e.reload()})),p.zc(6,"reload"),p.Qb(),p.Qb(),p.Rb(7,"div",3),p.Rb(8,"ps-form",4),p.Rb(9,"mat-card"),p.Rb(10,"form",5),p.Rb(11,"mat-form-field"),p.Rb(12,"mat-label"),p.zc(13,"Input 1"),p.Qb(),p.Mb(14,"input",6),p.Qb(),p.Rb(15,"mat-form-field"),p.Rb(16,"mat-label"),p.zc(17,"Input 2"),p.Qb(),p.Mb(18,"input",7),p.Qb(),p.Qb(),p.Qb(),p.Rb(19,"mat-card",8),p.zc(20,"dummy card"),p.Qb(),p.Pb(21,9),p.Rb(22,"button",10),p.zc(23,"dummy button 1"),p.Qb(),p.Rb(24,"button",10),p.zc(25,"dummy button 2"),p.Qb(),p.Ob(),p.Qb(),p.Rb(26,"mat-card",11),p.xc(27,J,3,3,"div",12),p.Qb(),p.Qb()),2&t&&(p.Ab(1),p.ic("ngModel",e.loadError),p.Ab(2),p.ic("ngModel",e.saveError),p.Ab(5),p.ic("dataSource",e.dataSource),p.Ab(2),p.ic("formGroup",e.form),p.Ab(17),p.ic("ngForOf",e.logs))},directives:[a.a,n.a,i.n,i.q,s.a,Q,i.v,i.o,i.i,c.d,c.h,d.a,i.c,i.g,o.l],pipes:[o.g],styles:["\n      .app-form-data-source-demo__settings {\n        margin-bottom: 1em;\n      }\n\n      .app-form-data-source-demo__settings mat-checkbox {\n        margin: 1em;\n      }\n\n      .app-form-data-source-demo__grid {\n        display: grid;\n        grid-template-columns: 2fr 1fr;\n        grid-gap: 1em;\n      }\n\n      .app-form-data-source-demo__log-item {\n        margin-bottom: 0.25em;\n        padding-bottom: 0.25em;\n        border-bottom: 1px solid #ccc;\n        font-size: 0.95em;\n      }\n\n      app-form-demo .mat-form-field {\n        display: block;\n      }\n    "],encapsulation:2,changeDetection:0}),t})();function H(t,e){1&t&&p.Mb(0,"app-form-data-source-demo")}let U=(()=>{class t{constructor(){this.demoType="dataSource"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=p.Fb({type:t,selectors:[["app-form-demo"]],decls:7,vars:4,consts:[[1,"app-form-demo__settings"],[3,"ngModel","ngModelChange"],[3,"value"],[3,"ngSwitch"],[4,"ngSwitchCase"]],template:function(t,e){1&t&&(p.Rb(0,"mat-card",0),p.Rb(1,"mat-form-field"),p.Rb(2,"mat-select",1),p.Yb("ngModelChange",(function(t){return e.demoType=t})),p.Rb(3,"mat-option",2),p.zc(4,"dataSource"),p.Qb(),p.Qb(),p.Qb(),p.Qb(),p.Pb(5,3),p.xc(6,H,1,0,"app-form-data-source-demo",4),p.Ob()),2&t&&(p.Ab(2),p.ic("ngModel",e.demoType),p.Ab(1),p.ic("value","dataSource"),p.Ab(2),p.ic("ngSwitch",e.demoType),p.Ab(1),p.ic("ngSwitchCase","dataSource"))},directives:[a.a,c.d,u.a,i.n,i.q,F.k,o.o,o.p,W],styles:[".app-form-demo__settings[_ngcontent-%COMP%] {\n        margin-bottom: 1em;\n      }"],changeDetection:0}),t})();r("89kn");let X=(()=>{class t{}return t.\u0275mod=p.Jb({type:t}),t.\u0275inj=p.Ib({factory:function(e){return new(e||t)},imports:[[i.j,i.s,o.c,T.b.forRoot(B.a),j.a,$,b.d.forChild([{path:"",component:U}]),d.b,c.f,a.c,n.b,u.b,s.b]]}),t})()},BwBJ:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var o=r("Efrr"),i=r("5uGe"),s=r("ryP2");function a(t,e=o.a){var r;const i=(r=t)instanceof Date&&!isNaN(+r)?+t-e.now():Math.abs(t);return t=>t.lift(new n(i,e))}class n{constructor(t,e){this.delay=t,this.scheduler=e}call(t,e){return e.subscribe(new c(t,this.delay,this.scheduler))}}class c extends i.a{constructor(t,e,r){super(t),this.delay=e,this.scheduler=r,this.queue=[],this.active=!1,this.errored=!1}static dispatch(t){const e=t.source,r=e.queue,o=t.scheduler,i=t.destination;for(;r.length>0&&r[0].time-o.now()<=0;)r.shift().notification.observe(i);if(r.length>0){const e=Math.max(0,r[0].time-o.now());this.schedule(t,e)}else this.unsubscribe(),e.active=!1}_schedule(t){this.active=!0,this.destination.add(t.schedule(c.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))}scheduleNotification(t){if(!0===this.errored)return;const e=this.scheduler,r=new d(e.now()+this.delay,t);this.queue.push(r),!1===this.active&&this._schedule(e)}_next(t){this.scheduleNotification(s.a.createNext(t))}_error(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()}_complete(){this.scheduleNotification(s.a.createComplete()),this.unsubscribe()}}class d{constructor(t,e){this.time=t,this.notification=e}}}}]);